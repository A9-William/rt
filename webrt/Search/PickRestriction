<& /Elements/TitleBoxStart, title => 'Restrict Search'&>
<FORM ACTION="Listing.html" METHOD="POST">
<INPUT TYPE=HIDDEN NAME="CompileRestriction" VALUE=1>

<ul>
<li>Owner is  <& /Elements/SelectBoolean, Name => "OwnerOp", TrueVal=> '=', FalseVal => '!=' &> 
<& /Elements/SelectOwner, Name => "ValueOfOwner" &>

<li>
Requestor email address <& /Elements/SelectMatch, Name => "RequestorOp", True => "matches", 
			   False => "does not match", Like => "Contains" &>
<INPUT Name="ValueOfRequestor" SIZE=20>

<li>
Subject <& /Elements/SelectMatch, Name => "SubjectOp", True => "matches", False => "does not match", 
	Like => "contains" &> 
<INPUT Name="ValueOfSubject" SIZE=20>

<li>Queue  <& /Elements/SelectBoolean, Name => "QueueOp" , True => "is", False => "isn't", TrueVal=> '=', FalseVal => '!=' &>
<& /Elements/SelectQueue, Name => "ValueOfQueue" &>

<li>
<& /Elements/SelectDateType, Name => 'DateType' &>
<& /Elements/SelectDateRelation, Name=>"DateOp" &>
<& /Elements/SelectDate, Name  => "ValueOfDate", ShowTime => 0 &>

<li>Ticket content 
<& /Elements/SelectBoolean, Name => "ContentOp", True => "matches", 
	False => "does not match", TrueVal => 'LIKE', FalseVal => 'NOT LIKE' &> <Input Name="ValueOfContent" Size=20>

<li>Status 
<& /Elements/SelectBoolean, Name => "StatusOp", True => "is", False => "isn't", TrueVal=> '=', FalseVal => '!=' &>  
<& /Elements/SelectStatus, Name => "ValueOfStatus" &>

% while ( my $KeywordSelect = $KeywordSelects->Next ) {
%   my $Descendents = $KeywordSelect->KeywordObj->Descendents;
<li><% $KeywordSelect->Name %>
<& /Elements/SelectBoolean, Name => "KeywordSelectOp". $KeywordSelect->id, True => "is", False => "isn't", TrueVal=> '=', FalseVal => '!=' &>
%#TODO: move the keywordSelect select out ot a seperate file
<SELECT NAME="KeywordSelect<% $KeywordSelect->id %>">
<OPTION VALUE="">-</OPTION>
%   foreach my $kid ( keys %{$Descendents} ) {
<OPTION VALUE="<% $kid %>"><% $Descendents->{$kid} %></OPTION>
%   }
</SELECT>
% }

<li><& /Elements/Checkbox, Name => "LimitResultsPerPage",  Default=>'checked' &>
Results per page
<& /Elements/SelectResultsPerPage, Name => "ValueOfResultsPerPage" &>

</UL>


</DIV>


<& /Elements/TitleBoxEnd &>

<& /Elements/Submit &>

</FORM>


 <%INIT>
 my $KeywordSelects = new RT::KeywordSelects $session{'CurrentUser'};
 foreach ( $session{'tickets'}->RestrictionValues('Queue') ) {
        $KeywordSelects->LimitToQueue($_);
 }

 $KeywordSelects->IncludeGlobals;
</%INIT>
