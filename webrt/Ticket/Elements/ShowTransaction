 <& /Elements/TitleBoxStart, title => $Transaction->Description." at ".$Transaction->CreatedAsString, titleright=> $Transaction->Message->First ? ($RT::WebOptions{ExtraTransactionActions}->(Transaction=>$Transaction) . "[<a href=\"Create.html?Queue=".$Transaction->TicketObj->QueueObj->id."&DependsOn=".$Transaction->Ticket."&QuoteTransaction=".$Transaction->id."\">New Dependent Ticket</a>]&nbsp;|&nbsp;[<a href=\"Update.html?id=".$Transaction->Ticket . "&QuoteTransaction=".$Transaction->Id."&tAction=Respond\">Reply</a>&nbsp;/&nbsp;<a href=\"Update.html?id=".$Transaction->Ticket . "&QuoteTransaction=".$Transaction->Id."&Action=Comment\">Comment</a>]</a>") : "" &>

    <TABLE WIDTH="100%">
      <TR>
	<TD VALIGN=TOP WIDTH="20%">
	  <& /Elements/ShadedBox, title => 'Date' , content => $Transaction->CreatedAsString &>
	</TD>
	<TD VALIGN=TOP WIDTH="20%">
	  <& /Elements/ShadedBox, title => 'Id' , content => $Transaction->Id &>
	</TD>
	<TD VALIGN=TOP WIDTH="20%"> 
	  <& /Elements/ShadedBox, title => 'Actor' , content => $Transaction->Creator->UserId &>
	</TD>
	<TD VALIGN=TOP WIDTH="20%">
	  <& /Elements/ShadedBox, title => 'Time Worked' , content => $TimeTaken &>
	</TD>
	
	
      </TR>
    </TABLE>

%# I had to temporarly move this one because the box grew too wide when a message was too wide.
<& /Elements/TitleBoxEnd &>

% $attachments->GotoFirstItem();
%  while (my $message=$attachments->Next) {


<pre>
%if ($FullHeaders) {
<%$message->Headers %>
<A HREF="Display.html?id=<%$Transaction->TicketObj->id%>">Brief headers</a>

% } else {
<%$message->NiceHeaders %>
<A HREF="Display.html?ShowHeaders=<%$Transaction->Id%>&id=<%$Transaction->TicketObj->id%>">Full headers</a>
%}

</pre>

%   if ($message->ContentType =~ m{^(text/plain|message)} && length($message->Content)<13456) {
<pre>
%#TODO We're now HTML escaping the message content, but should
%#TODO probably deal with converting links
<% $message->Content %>
</pre>
%    }  
% elsif ($message->ContentType =~ m{^multipart}) {
This is a multipart message
% } else {
	
Attachment: <A HREF="Display.html?ShowAttachment=<%$message->Id%>"><% $message->ContentType %></a>
%if ($message->ContentType =~ m{^text/(?!plain)}) {
	<A HREF="Display.html?ShowAttachment=<%$message->Id%>&plaintext=1">View as plain text</a>
%}
%    }
% }



<%ARGS>
$Transaction => undef
$TimeTaken => undef
$FullHeaders => undef
</%ARGS>

<%INIT>
if ($Transaction->TimeTaken > 0) {
	$TimeTaken = $Transaction->TimeTaken." minutes"
}
my $attachments = $Transaction->Attachments;

</%INIT>
