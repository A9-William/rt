<INPUT TYPE=HIDDEN NAME="CheckACL"  VALUE="<%$ACLDesc%>">
     <TABLE BORDER=0>
<TR>
<TD valign=top>
<h3><&|/l&>New rights</&></h3> 
<SELECT SIZE=5  MULTIPLE  NAME="GrantRight-<%$ACLDesc%>">
% foreach $right (sort keys %Rights) {
      <OPTION VALUE="<%$right%>"  
	><% loc($right) %></OPTION>
% }
<OPTION VALUE="" SELECTED><&|/l&>(no value)</&></OPTION>
</SELECT>
</TD>
<TD valign=top> 
<h3><&|/l&>Current rights</&></h3>
<i>(<&|/l&>Check box to revoke right</&>)</i> <BR>
% while (my $right = $ACLObj->Next()) {
% if ($right->RightName) {
<input type=checkbox value="<%$right->Id%>" name="RevokeRight-<%$ACLDesc%>-<%$right->RightName%>"> <% loc($right->RightName) %><br>
% }
%  }
</TD>
</TR>
</TABLE>
<%INIT>
    my ($right, $ACLDesc, $AppliesTo, %Rights);
       
    my $ACLObj = new RT::ACL($session{'CurrentUser'});
    my $ACE = new RT::ACE($session{'CurrentUser'});


    $ACLObj->LimitToObject( Id => $ObjectId, Type => $ObjectType);
    $ACLObj->LimitToPrincipal( Id => $PrincipalId);#, Type => $PrincipalType);

    if ($ObjectType eq 'Group') { 
        %Rights = $ACE->GroupRights();
    } 

    elsif ($ObjectType eq 'Queue') { 
        %Rights = $ACE->QueueRights();
    } 
    elsif ($ObjectType eq 'System') {
        %Rights =  ( $ACE->SystemRights , $ACE->QueueRights(),$ACE->GroupRights());
    }

    
    $ACLDesc = "$PrincipalType-$PrincipalId-$ObjectType-$ObjectId";
</%INIT>
    
<%ARGS>
$PrincipalType => undef
$PrincipalId => undef
$ObjectId => 0
$ObjectType => undef
</%ARGS>
