<&| /Widgets/TitleBox, title => loc('GnuPG private key for [_1]', $EmailAddress) &>
% if ( $res{'exit_code'} || !keys %{ $res{'info'} } ) {
<% loc('No private key') %>
% } else {
<table>

<tr><th><% loc('Created') %>:</th>
<td><% $res{'info'}{'Created'}? $res{'info'}{'Created'}->AsString( Time => 0 ): loc('never') %></td></tr>

<tr><th><% loc('Expire') %>:</th>
<td><% $res{'info'}{'Expire'}? $res{'info'}{'Expire'}->AsString( Time => 0 ): loc('never') %></td></tr>

% foreach my $uinfo( @{ $res{'info'}{'User'} } ) {
<tr><th><% loc('User (created - expire)') %>:</th>
<td><% $uinfo->{'String'} %>\
(<% $uinfo->{'Created'}->AsString( Time => 0 ) %> - \
<% $uinfo->{'Expire'}? $uinfo->{'Expire'}->AsString( Time => 0 ): loc('never') %>)
</td></tr>
% }

</table>
% }
</&>

<%ARGS>
$EmailAddress
</%ARGS>
<%INIT>
require RT::Crypt::GnuPG;
my %res = RT::Crypt::GnuPG::GetPrivateKeyInfo( $EmailAddress );

</%INIT>

