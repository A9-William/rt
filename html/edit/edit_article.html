%# BEGIN LICENSE BLOCK
%# 
%#  Copyright (c) 2002 Jesse Vincent <jesse@bestpractical.com>
%#  
%#  This program is free software; you can redistribute it and/or modify
%#  it under the terms of version 2 of the GNU General Public License 
%#  as published by the Free Software Foundation.
%# 
%#  A copy of that license should have arrived with this
%#  software, but in any event can be snarfed from www.gnu.org.
%# 
%#  This program is distributed in the hope that it will be useful,
%#  but WITHOUT ANY WARRANTY; without even the implied warranty of
%#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%#  GNU General Public License for more details.
%# 
%# END LICENSE BLOCK

<& /Elements/Header, Title => $article->Summary &>
<& /Elements/NavBar &>

<%join ('<BR>',@results)|n%>
<form method="post" action="edit_article.html" enctype="form/multipart">
<input type=hidden name="id" value="<%$article->Id%>">
<input type=hidden name="DisplayRoot" value="<%$DisplayRoot%>">
<input type=hidden name="EditArticle" value="<%$article->Id%>">
<h1><%$article->Summary%></h1>

<h2.Related Tickets</h2>

<& /Elements/ListRelatedTickets, article => $article &> 


<HR>
Summary: <input size=70 name="RT::FM::Article-<%$article->Id%>-Summary" value="<%$article->Summary%>"><BR>

Parent: <& /Elements/ArticleSelect, Name => "RT::FM::Article-".$article->Id . "-Parent", Default => $article->ParentObj->Id &><BR>

Children:
<ul>
% while (my $child = $children->Next) {
<li><input type=hidden name="EditArticle" value="<%$child->Id%>">
SortOrder: <input size=2 name="RT::FM::Article-<%$child->Id%>-SortOrder" value="<%$child->SortOrder%>">
<%$child->Summary%>
</li>
% }
</ul>



<& /Elements/ArticleSelectCustomFields, ArticleObj => $article &>
<BR>
<textarea cols=70 rows=20 name="RT::FM::Article-<%$article->Id%>-Content"><%$article->ContentObj->Body%></textarea>
<br>
<input type=submit>
</form>

<div align=right>
<a href="../article.html?id=<%$DisplayRoot%>#<%$article->Id%>">[Display article]</a>
</div>
</body>
</html>

<%INIT>

my @results = UpdateArticles(ARGSRef => \%ARGS);
my $article = new RT::FM::Article($session{'CurrentUser'});
$article->Load($id);

my $children = $article->Children();

</%INIT>
<%ARGS>
$DisplayRoot => 1
$id => 0
</%ARGS>
