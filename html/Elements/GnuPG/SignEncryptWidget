<table>
<td><% loc('Sign')%></td>
<td><& /Widgets/Form/Boolean:InputOnly, Name => 'Sign', CurrentValue => $ARGS{'Sign'} &>
using <& /Elements/SelectKeyForSigning, Addresses => \@signers &>
</td>
<td><% loc('Encrypt')%></td>
<td><& /Widgets/Form/Boolean:InputOnly, Name => 'Encrypt', CurrentValue => $ARGS{'Encrypt'} &></td>
</table>
<%ARGS>
$QueueObj
</%ARGS>
<%INIT>
return unless RT->Config->Get('GnuPG')->{'Enable'};

my @signers;
push @signers, ($ARGS{'UpdateType'}||'') eq "private"
    ? ( $QueueObj->CommentAddress || RT->Config->Get('CommentAddress') )
    : ( $QueueObj->CorrespondAddress || RT->Config->Get('CorrespondAddress') );
push @signers, $session{'CurrentUser'}->EmailAddress;
</%INIT>

<%METHOD Process>
<%ARGS>
$QueueObj
$Arguments => {}
</%ARGS>
<%INIT>
return unless RT->Config->Get('GnuPG')->{'Enable'};

foreach ( qw(Sign Encrypt) ) {
    $Arguments->{ $_ } = $m->comp( '/Widgets/Form/Boolean:Process',
        Name => $_,
        DefaultValue => $QueueObj->$_,
        Arguments => $Arguments,
    );
}
</%INIT>
</%METHOD>
