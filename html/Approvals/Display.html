%# BEGIN LICENSE BLOCK
%# 
%# Copyright (c) 1996-2002 Jesse Vincent <jesse@bestpractical.com>
%# 
%# (Except where explictly superceded by other copyright notices)
%# 
%# This work is made available to you under the terms of Version 2 of
%# the GNU General Public License. A copy of that license should have
%# been provided with this software, but in any event can be snarfed
%# from www.gnu.org
%# 
%# This work is distributed in the hope that it will be useful, but
%# WITHOUT ANY WARRANTY; without even the implied warranty of
%# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
%# General Public License for more details.
%# 
%# 
%# Unless otherwise specified, all modifications, corrections or
%# extensions to this work which alter its source code become the
%# property of Best Practical Solutions, LLC when submitted for
%# inclusion in the work.
%# 
%# 
%# END LICENSE BLOCK
<& /Elements/Header, Title =>  $title &>

<& Elements/Tabs, current_tab => "Approvals/Display.html" &>
<form method=post action="<%$RT::WebPath%>/Approvals/">
<& /Elements/TitleBoxStart, title => $title &>
<table width=100%>
<& Elements/Approve, ticket => $Ticket &>
</table>
<& /Elements/TitleBoxEnd&>
<& /Elements/Submit&>
</form>
<& /Ticket/Elements/ShowSummary, Ticket => $Ticket &>

<& /Ticket/Elements/ShowHistory , Ticket => $Ticket, Collapsed => 0, ShowTitle => 0, ShowHeaders => 0 &>
<br>

<h2><&|/l&>Tickets which depend on this approval:</&></h2>

<table widht=100%>
<TR>
<TD WIDTH="50">&nbsp;</TD><TD>
% my $approving = $Ticket->DependedOnBy();
% while (my $link = $approving->Next()) {
%    next unless ($link->BaseURI->IsLocal());
<h3>#<%$link->BaseObj->Id%>: <%$link->BaseObj->Subject%></h3>
<font size="-1">
<& /Ticket/Elements/ShowSummary, Ticket => $link->BaseObj &>    

%#<& /Ticket/Elements/ShowHistory , Ticket => $link->BaseObj, Collapsed => 0, ShowTitle => 0, ShowHeaders => 0 &>
</font>     

<BR><HR><BR>
% }
</TD>
</TR>
</TABLE>

<%init>
my $Ticket = LoadTicket($id);

my $title = loc("Approval #[_1]: [_2]", $Ticket->Id, $Ticket->Subject);




</%init>
<%ARGS>
$id => undef
</%ARGS>
