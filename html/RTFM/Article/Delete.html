<& /RTFM/Article/Elements/Tabs, Article => $ArticleObj, current_subtab =>
"RTFM/Article/Delete.html?id=".$ArticleObj->Id , id => $id, Title => $title &>


% if ($ARGS{'Delete'}) {

<%$title%>
<& /Elements/ListActions, actions => \@results &>

% } else { 
<b><&|/l&>Are you sure you want to delete this article?</&></b>
<table>
<tr>
<td align="left">
<form action="Display.html?id=<%$ArticleObj->Id%>" method="get" >
<input type=submit value="<&|/l&>No</&>">
</form>

</td>
<td align="right">
<form action="Delete.html" method="POST" >
<INPUT TYPE=HIDDEN NAME=id VALUE="<%$ArticleObj->Id%>">
<INPUT TYPE="HIDDEN" NAME="Delete" VALUE="yes">
<input type=submit value="<&|/l&>Yes</&>">
</form>
</td>

</tr>
</table>
% }
<%INIT>

my @results;

my $title;
my $ArticleObj = RT::FM::Article->new( $session{'CurrentUser'} );


$ArticleObj->Load($id);
unless ( $ArticleObj->id ) {
    $m->comp("/RTFM/Elements/Error", Why =>  loc("Unable to load article") );
}


unless ( $ArticleObj->CurrentUserHasRight('ModifyArticle') ) {
    $m->comp("/RTFM/Elements/Error", Why => "No permission to modify article");
}

if ($ARGS{'Delete'} eq 'yes') {
    $ArticleObj->Delete();
    $title = loc('Article #[_1] deleted', $ArticleObj->Id);
}

else {
    $title = loc('Delete article #[_1]', $ArticleObj->Id);
}
</%INIT>
<%ARGS>
$id => undef
</%ARGS>
